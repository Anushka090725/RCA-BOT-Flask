<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RCA Bot Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      padding-top: 50px;
      background-color: #f5f7fa;
    }
    .container {
      max-width: 700px;
    }
    .loading {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container text-center">
    <h1 class="mb-4">üö® RCA Bot Dashboard</h1>
    <p class="text-muted">Click the button below to run real-time RCA analysis using Grafana alerts + Prometheus + EFK</p>
    
    <button id="runBtn" class="btn btn-primary btn-lg">Run RCA Analysis</button>
    
    <div class="loading mt-3">
      <div class="spinner-border text-primary" role="status"></div>
      <p class="mt-2">Processing RCA request...</p>
    </div>

    <div id="result" class="mt-4 text-start"></div>
  </div>

  <script>
    document.getElementById('runBtn').addEventListener('click', async () => {
      const loading = document.querySelector('.loading');
      const result = document.getElementById('result');
      result.innerHTML = '';
      loading.style.display = 'block';

      try {
        const res = await fetch('/run-rca', { method: 'POST' });
        const data = await res.json();
        loading.style.display = 'none';

        if (data.success) {
          result.innerHTML = `
            <h4>‚úÖ RCA Analysis Output</h4>
            <pre style="background:#fff; padding:15px; border-radius:8px; border:1px solid #ddd;">${data.rca_output}</pre>
          `;
        } else {
          result.innerHTML = `<div class="alert alert-danger">‚ùå ${data.error}</div>`;
        }
      } catch (err) {
        loading.style.display = 'none';
        result.innerHTML = `<div class="alert alert-danger">‚ùå Error running RCA</div>`;
        console.error(err);
      }
    });
  </script>
</body>
</html>
